# HOXY 프로젝트 컨텍스트

## 프로젝트 개요
HOXY는 다양한 운세/행운 관련 서비스를 제공하는 플랫폼입니다.

## 서비스 목록
1. **HOXY NUMBER** - 로또 번호 생성기 (index.html)
2. **부자가 될 상인가?** - AI 관상 테스트 (face-test.html)
3. 준비 중 - 추후 공개
4. 준비 중 - 추후 공개

## 기술 스택
- **Frontend**: HTML, CSS (Tailwind CDN), Vanilla JavaScript
- **Storage**: LocalStorage + Firebase Firestore
- **Backend**: Firebase (Firestore Database)
- **Hosting**: Cloudflare Pages
  - Repository: https://github.com/Dunsmile/hoxy-number.git
  - Live URL: https://hoxy-number.pages.dev

## 주요 파일
- `index.html` - HOXY NUMBER (로또 번호 생성기)
- `face-test.html` - 관상 테스트 페이지
- `js/app.js` - 로또 앱 로직
- `js/face-test.js` - 관상 테스트 로직
- `css/style.css` - 공통 스타일

## 핵심 기능
1. **로또 번호 생성** - 1~45 중 6개 랜덤 생성
2. **일일 할당량 시스템** - 기본 10회/일, 무료 충전 시 +5회 추가 (12시간 3회 제한)
3. **연속 5회 뽑기** - 한 번에 5개 번호 생성
4. **슬롯 시스템** - 최근 생성 번호 저장 (기본 5슬롯, +5 확장, 최대 50)
5. **번호 관리** - 저장 번호 페이지네이션 (페이지당 10개), 빈 슬롯 표시
6. **당첨 확인** - 1등~5등 당첨 등수 표시 + 실제 당첨금 표시
7. **오늘의 럭키 넘버** - 12시간 주기 갱신, 모달 애니메이션 후 공개, 저장 가능
8. **양방향 스와이프** - 좌→우: 저장, 우→좌: 삭제 (확인 모달)
9. **당첨 회차 선택** - 최근 10회차 드롭다운 (Firestore 캐싱)
10. **당첨 보상 시스템** - 등수별 화려한 UI + 축하 팝업 + 실제 당첨금

## 코딩 스타일
- 한국어 주석 사용
- 함수명: camelCase
- 이모지 사용 (사용자 선호)
- 모바일 우선 반응형 디자인

## 최근 작업 이력
- ✅ Firebase 백엔드 통합 완료 (commit: 575f300)
- ✅ GitHub Pages 퍼블리싱 완료
- ✅ Git 저장소 초기화 및 설정 완료
- ✅ v1.2 UI/UX 대규모 개선 (2026-02-03)
- ✅ v1.3 버그 수정 및 기능 개선 (2026-02-03)
- ✅ v1.4 SEO 최적화 및 Google AdSense 연동 (2026-02-05)
- ✅ v1.5 관상 테스트 서비스 추가 (2026-02-05)

## Firebase 설정
- **Project ID**: hoxy-number
- **Auth Domain**: hoxy-number.firebaseapp.com
- **Database**: Firestore
- **Storage**: hoxy-number.firebasestorage.app

### Firestore 컬렉션
- `generated_numbers`: 사용자가 생성한 번호 저장
- `winning_numbers`: 당첨 번호 캐시 (회차별 당첨 정보 + 등수별 당첨금)
- `face_test_results`: 관상 테스트 결과 (이름, 성별, 생년월일, 결과해시)

## 중요 설정값
```javascript
const DEFAULT_QUOTA = 10;        // 일일 생성 횟수
let recentSlots = 5;             // 기본 슬롯 수 (최대 50)
let savedUnlockedPages = 1;      // 저장 번호 잠금해제 페이지 수
let savedItemsPerPage = 10;      // 페이지당 항목 수
```

## LocalStorage 키
- `hoxy_quota`: 일일 생성 할당량
- `hoxy_recent`: 최근 생성 번호
- `hoxy_saved`: 저장된 번호
- `hoxy_lucky`: 오늘의 행운 번호
- `hoxy_winning`: 현재 선택된 당첨 정보 (prizes 포함)
- `hoxy_recent_slots`: 슬롯 개수
- `hoxy_pages_unlocked`: 최근 번호 페이지 잠금 해제 수
- `hoxy_saved_pages_unlocked`: 저장 번호 페이지 잠금 해제 수

## 디자인 특징
- 그라데이션 UI (생동감 있는 효과)
- 부드러운 애니메이션과 트랜지션
- 직관적이고 터치 친화적인 인터페이스
- 모달 최대 너비 480px로 최적화
- PC/모바일 반응형 레이아웃

## 프로젝트 정보
- **버전**: v1.8 (2026-02-06 UX 개선 + 럭키넘버 기능 강화)
- **이전 버전**: v1.7, v1.6, v1.5, v1.4, v1.3, v1.2, v1.1, v1.0
- **개발자**: 스티브 (UX/UI Designer & Developer)
- **연락처**: poilkjmnb122@gmail.com
- **라이센스**: MIT License

## 🏭 도파민 공작소 (통합 플랫폼)
- **Repository**: https://github.com/Dunsmile/dopamine-factory
- **설명**: 서비스 통합 포털 (HOXY 시리즈 + 팀원 서비스)
- **상태**: 초기 설정 완료, 배포 대기

## 🎯 비즈니스 모델 & 수익화 전략

### 핵심 전략
**소셜 프루프 기반 사용자 유입 퍼널**
- 홈페이지에 "이 사이트에서 당첨자 X명 배출!" 카드 UI 표시
- 신규 방문자들이 실제 당첨 사례를 보고 신뢰하여 서비스 사용 유도
- 로또 → 사주/운세 서비스로 확장 예정

### 수익화 방식
1. **1단계 (현재)**: 완전 무료 + Google AdSense 배너 광고
   - 페이지 내 자연스러운 광고 배치
   - "무료 충전" 기능으로 사용자 편의 제공 (광고 강제 아님)
   - 할당량 추가, 슬롯 확장 등 편의 기능
2. **2단계 (추후)**: 프리미엄 서비스
   - 무제한 생성, 고급 통계, 사주/운세 서비스 등

### 저장 로직 통일 (광고 수익 보호)
- **홈 탭**: `recentSlots` 기준으로만 저장 가능
- **내 번호 탭**: `savedUnlockedPages * 10` 기준으로만 저장/표시
- **당첨 확인 탭**: 내 번호 탭과 동일한 범위만 표시

## 🚧 현재 개발 상태

### ✅ 완료된 작업
- Firebase Firestore 설정 완료
- 번호 생성 시 DB 저장 구현 완료
- 개발자 모드에서 데이터 저장 확인 완료
- 광고 시청 UI 구현 완료 (실제 광고 미연동)
- 동행복권 API 연동 완료 (최신 회차 당첨 번호 자동 업데이트)
- 당첨 회차 드롭다운 개선 (Firestore 캐싱)

### ✅ v1.2 업데이트 (2026-02-03)

#### 스와이프 UX 개선
- 양방향 스와이프 → **좌측 스와이프만** 활성화
- 스와이프 시 **iOS 스타일 액션시트** 표시 (저장/삭제/취소)
- 스와이프 힌트 화살표 애니메이션 추가

#### PC/모바일 반응형 네비게이션
- **PC (768px+)**: 상단 GNB에 탭 네비게이션
- **모바일**: 하단 FNB 유지
- 콘텐츠 최대 너비: 모바일 448px / PC 576px

#### PC 반응형 요소 크기 조정
- 숫자 공: 32px → 40px (PC)
- 텍스트: xs → sm (PC)
- 간격/패딩 증가 (PC)

#### 당첨 보상 시스템
- **등수별 카드 스타일**: 1등(금), 2등(은), 3등(동), 4-5등(초록)
- **축하 팝업 모달**: 회차, 등수, 일치 번호, 당첨금 표시
- **컨페티 효과**: 1~3등 당첨 시

### ✅ v1.3 업데이트 (2026-02-03)

#### 버그 수정
- **GNB 탭 클릭 영역**: 텍스트/아이콘에 `pointer-events-none` 적용
- **전체 저장 버그**: `recentSlots` 기준으로만 저장 (확장된 슬롯만)
- **저장 제한**: `savedUnlockedPages * 10` 초과 시 저장 불가 + 안내 메시지
- **당첨 확인 탭**: 잠금해제된 페이지 범위만 표시 (광고 수익 보호)
- **당첨금 API 필드**: `wonmoney` → `payoutStr` 수정

#### 기능 개선
- **저장된 번호 빈 슬롯 표시**: 저장 가능 공간 시각화
- **저장 현황 카운터**: "n/m개 저장됨" 표시
- **실제 당첨금 표시**: 고정값 → API 실제 데이터 (win1~win5)
- **Firestore prizes 저장**: 등수별 당첨금 전체 저장

### ✅ v1.4 업데이트 (2026-02-05)

#### SEO 최적화
- 메타 태그 추가 (description, keywords, robots, author)
- Open Graph 태그 (Facebook, KakaoTalk 공유)
- Twitter Card 태그
- JSON-LD 구조화 데이터 (검색 리치 스니펫)
- robots.txt, sitemap.xml 생성
- og-image.png 생성 (1200x630)

#### Google AdSense 연동
- 메타 태그: `google-adsense-account`
- 스크립트: `adsbygoogle.js`
- ads.txt 생성
- Publisher ID: `ca-pub-7301223136166743`

#### 필수 페이지 추가 (설정 > 기타)
- 서비스 소개
- 개인정보처리방침
- 이용약관

#### 관리자 기능
- 관리자 로그인 (설정 > 기타 > 관리자)
- ID: dunsmile / PW: a123
- 로그인 후 관리 기능 표시 (할당량 초기화, 데이터 삭제)

### ✅ v1.5 업데이트 (2026-02-05)

#### 관상 테스트 서비스 추가
- **URL**: /face-test.html
- **서비스명**: "부자가 될 상인가?"

#### 서비스 메뉴 (햄버거 메뉴)
- GNB 좌측 햄버거 버튼 (☰)
- 사이드바에서 서비스 간 이동
- 각 서비스에 교차 홍보 배너 추가

#### 관상 테스트 기능
- 입력: 이름, 성별, 생년월일, 사진(5MB 이하)
- 분석 로딩 애니메이션
- 결과 화면: 부자 확률, 유명인 매칭, 분석 텍스트
- 해시 기반 일관된 결과 (동일 정보 = 동일 결과, 사진 무관)
- 20가지 행운 메시지 랜덤 표시
- 10명 유명인 매칭 (정주영, 빌게이츠 등)
- Firebase 저장 (사진 제외)
- 공유하기 기능

#### 관상 테스트 데이터 구조
```javascript
{
  name: '홍길동',
  gender: 'male',
  birthDate: '1990-01-15',
  resultHash: 123456789,
  richPercent: 87,      // 65~94%
  luckPercent: 73,      // 50~89%
  celebrity: '정주영',
  createdAt: timestamp
}
```

### ✅ v1.6 업데이트 (2026-02-05) - UT 피드백 반영

#### 스와이프/롱프레스 UX 변경
- **모바일**: 스와이프 → 삭제만 (저장 버튼 제거)
- **모바일**: 롱프레스(0.8초) → 저장 확인 모달
- **PC**: 호버 시 저장/삭제 버튼 표시

#### 간격 최적화 (4px 그리드)
- 전체 패딩/마진 축소 (p-5 → p-3, gap-4 → gap-1 등)
- 모바일 레이아웃 타이트하게 조정
- 375px 이하 초소형 디바이스 지원

#### 남은 횟수 모두 뽑기 기능
- 할당량 4회 이하일 때 "광고 보고 남은 N회 모두 뽑기" 옵션 표시
- 기존 "5회 연속 뽑기"와 조건부 전환

#### 내 번호 탭 상단에 최근 번호 표시
- "최근 뽑은 번호" 섹션 추가 (최대 5개)
- 저장하지 않아도 최근 번호 확인 가능

#### 모바일 반응형 최적화 (375px 기준)
- 숫자 공 크기: 28px (모바일) / 32px (400px+) / 36px (PC)
- 폰트 크기 전체 축소
- 요소 overflow 방지

### ✅ v1.7 업데이트 (2026-02-06) - 당첨 통계 UI

#### 당첨 통계 시스템
- **PC 우측 사이드바**: 이번주 당첨 현황 + 역대 당첨 기록 카드
- **모바일 상단 배너**: 한 줄 미니멀 통계 ("이번주 N명 당첨! | 역대 1등 N명 배출")
- **오늘 하루 숨김**: X 버튼으로 당일 숨김 (localStorage)

#### 당첨 통계 데이터 구조
- `winning_stats/weekly_{회차}`: 주간 통계 (1~5등)
- `winning_stats/all_time`: 역대 통계 (1~3등만)
- Firestore에서 실시간 로드

#### 스와이프/롱프레스 버그 수정
- 이벤트 위임 방식으로 변경 (DOM 재생성 시에도 동작)
- 스와이프 → 삭제, 롱프레스(0.8초) → 저장

#### UI 개선
- 하단 FNB z-index: 50 추가 (콘텐츠 위에 표시)
- 내 번호 탭 "홈에서 더 보기" 버튼 제거
- 모바일 스와이프 안내 텍스트 PC에서 숨김

### ✅ v1.8 업데이트 (2026-02-06) - UX 개선 + 럭키넘버 강화

#### UI 문구 변경 (AdSense 정책 준수)
- "광고 보고 +5회" → "🎁 무료 횟수 +5회 충전"
- "광고 시청" → "무료 충전"
- "광고보고 연속 5회 뽑기" → "연속 5회 뽑기"
- 슬롯/페이지 추가 버튼 문구에서 "광고" 제거

#### 스와이프 기능 개선 (양방향)
- **좌→우 스와이프**: 저장 확인 모달
- **우→좌 스와이프**: 삭제 확인 모달
- **롱프레스 기능 제거** (심플화)
- 힌트 텍스트: "← 삭제 | 저장 →"

#### 럭키넘버 기능 강화
- **모달 애니메이션**: "행운을 불러오는 중..." (3초)
- **번호 확인하기 버튼**: 모달에서 클릭 후 홈 화면 공개
- **공개 애니메이션**: 카드 scale + fade-in 효과
- **저장 버튼 추가**: 럭키넘버를 내 번호에 저장 가능
- **저장 완료 처리**: 중복 저장 방지 UI

#### 버그 수정
- 홈에서 최근 번호 삭제 시 내 번호 탭 프리뷰 동기화

#### CSS 애니메이션 추가
- `.lucky-bounce`: 럭키넘버 아이콘 바운스
- `.lucky-dot`: 로딩 점 애니메이션
- `.lucky-reveal-animation`: 공개 시 scale 효과
- `.lucky-actions-show`: 저장 버튼 슬라이드

### 🔄 진행 중
- Google AdSense 승인 대기
- Cloud Function으로 당첨 통계 자동 계산 (Firebase Blaze 요금제 필요)

### 📋 다음 단계별 작업 계획

**Phase 1: 핵심 기능 완성** ✅ 완료
1. ✅ 동행복권 API 연동
2. ✅ SEO 최적화 및 메타 태그
3. ✅ Google AdSense 코드 연동

**Phase 2: 서비스 확장** ✅ 완료
4. ✅ 관상 테스트 서비스 추가
5. ✅ 서비스 메뉴 (햄버거 메뉴) 구현
6. ✅ 교차 홍보 배너

**Phase 3: 수익화 (진행 중)**
7. ⏳ Google AdSense 승인 대기
8. ⬜ 실제 광고 연동 및 보상 지급 로직
9. ⬜ 당첨자 통계 시스템

**Phase 4: 추가 서비스 (계획)**
10. ⬜ 새로운 운세 서비스 추가
11. ⬜ 통계 대시보드
12. ⬜ 프리미엄 기능

## 🔗 외부 API 연동
- **동행복권 API** (lotto-haru.kr): 당첨 번호 + 등수별 당첨금
  - 응답 구조: `win.win1~win5.payoutStr`
- **Google AdSense**: 광고 수익화 (미연동)

## 📱 반응형 브레이크포인트
- **모바일**: < 768px (max-w-md: 448px)
- **PC**: >= 768px (max-w-xl: 576px)

## 🎨 CSS 클래스 (등수별 스타일)
```css
.rank-1  /* 1등 - 금색, 반짝임 */
.rank-2  /* 2등 - 은색, 글로우 */
.rank-3  /* 3등 - 동색 */
.rank-4  /* 4등 - 초록 */
.rank-5  /* 5등 - 연초록 */
```

## 📊 winningData 구조
```javascript
{
  drawNumber: 1209,
  drawDate: '2026-01-31',
  numbers: [2, 17, 20, 35, 37, 39],
  bonus: 24,
  firstPrize: '1,371,910,466',
  prizes: {
    win1: '1,371,910,466',  // 1등 당첨금
    win2: '68,908,745',     // 2등 당첨금
    win3: '1,601,509',      // 3등 당첨금
    win4: '50,000',         // 4등 당첨금
    win5: '5,000'           // 5등 당첨금
  }
}
```
